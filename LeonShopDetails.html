<!DOCTYPE html>
<html lang="zh-cn">
<head>
	<meta charset='utf-8'>
	<meta name="author" content="Leon">
	<meta name="description" content="在本页面中,提供了图片缩略图,选项卡,放大镜,鼠标指示区域,图片蒙版,鼠标滚动控制图片大小,鼠标拖动控制图片位置,文字蒙版,表单确认,表单序列化,打分功能等多个功能,作为一个小小的作品展示.其中也使用了bootstrap布局,jQuery插件编写,与主购物界面使用AJAX形成局部刷新的效果.">
	<link rel="shortcut icon" type="image/x-icon" href="./images/leon.ico">
	<title>Leon购物商品页</title>
	<link rel="stylesheet" type="text/css" href="js/bootstrap/css/bootstrap.min.css">
	<style type="text/css">
		.navbar-brand img{width: 40px;height: auto;margin-top: -10px;}
		.classify .list-group>p:first-child{background: rgba(50,50,50,1);color: white;padding: 4px;}
		.recommandBrand a{width: 45%;display: inline-block;line-height: 1.5em;}
		.thumbnailImg>img{width: 100%;height: auto;border: 1px dotted gray;z-index: 2;}
		.thumbnailImg li img{width: 20%;height: auto;display:inline-block;float: left;margin-right: 5%;}
		.detailedImg{margin: 10px auto;}
		.attr{border: 1px solid lightgray;border-top: none;padding: 5px;display: none;}
		.activeAttr{display: block;}
		.attr p{line-height: 25px;}
		.goodDesc p span:first-child{font-weight: bold;width: 100px;display: inline-block; text-align: center;}
		.onSale{color: rgb(255,153,18);font-size: 25px;}
		.score{cursor: pointer;}
		.input-sm{font-size: 15px;border: 0px;}
		.magnifying{width: 50%;height: auto;position: absolute;border: 1px solid black;display: none;z-index: 3;}
		.mouseTail{background-color: rgba(50,50,50,0.3);position: fixed;display: none;z-index: 3;}
	</style>
</head>
<body>
	<div class="container-fluid">
		<nav class="navbar navbar-default">
			<div class="container-fluid">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a href="#" class="navbar-brand"><img src="images/leon.png" alt="Brand"></a>
				</div>
				<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
					<ul class="nav navbar-nav">
						<li><a href="index.html">首页 <span class="sr-only">(Current)</span></a></li>
						<li><a href="resume.html">简历</a></li>
						<li class="active"><a href="LeonShop.html">Leon购物</a></li>
						<li><a href="learn.html">技能学习</a></li>						
						<li class="dropdown">
							<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="ture" aria-expanded="false">实例展示<span class="caret"></span></a>
							<ul class="dropdown-menu">
								<li><a href="demo/scrollWindow.html">视频滚动窗口</a></li>
								<li><a href="demo/form.html">表单功能</a></li>
								<li><a href="demo/AJAX.html">AJAX</a></li>
								<li><a href="demo/plugins.html">jQuery插件的编写</a></li>
							</ul>
						</li>
					</ul>
					<p class="nav navbar-nav navbar-right navbar-text">Leon的生活</p>
				</div>
			</div>
		</nav>
		<div class="container-fluid">
			<nav class="navbar navbar-inverse">
				<div class="container-fluid">
					<div class="collapse navbar-collapse">
						<ul class="nav navbar-nav">
							<li><a href="LeonShop.html">首页</a></li>
							<li class="active"><a href="LeonShopDetails.html">详情页</a></li>
							<li><a href="#">推荐品牌</a></li>
							<li><a href="#">女装</a></li>	
							<li><a href="#">男装</a></li>
							<li><a href="#">鞋包配饰</a></li>					
						</ul>
					</div>	
				</div>
			</nav>
			<div class="row">
				<div class="col-lg-2 classify">
					<div class="list-group">
						<p>商品分类</p>
						<li class="list-group-item recommandBrand">
							<p><strong>推荐品牌</strong></p>
							<a href="###">耐克<span class="glyphicon glyphicon-fire"></span></a>
							<a href="###">阿迪达斯</a>
							<a href="###">达芙妮</a>
							<a href="###">李宁</a>
							<a href="###">安踏</a>
							<a href="###">特步<span class="glyphicon glyphicon-fire"></span></a>
						</li>
						<li class="list-group-item recommandBrand">
							<p><strong>女装</strong></p>
							<a href="###">呢大衣</a>
							<a href="###">T恤<span class="glyphicon glyphicon-fire"></span></a>
							<a href="###">羽绒</a>
							<a href="###">羊绒衫</a>
							<a href="###">针织</a>
							<a href="###">连衣裙<span class="glyphicon glyphicon-fire"></a>
							<a href="###">皮外套</a>
						</li>
						<li class="list-group-item recommandBrand">
							<p><strong>男装</strong></p>
							<a href="###">衬衫</a>
							<a href="###">T恤衫</a>
							<a href="###">夹克<span class="glyphicon glyphicon-fire"></span></a>
							<a href="###">牛仔裤</a>
							<a href="###">西服</a>
							<a href="###">卫衣</a>
						</li>
						<li class="list-group-item recommandBrand">
							<p><strong>鞋包配饰</strong></p>
							<a href="###">围巾</a>
							<a href="###">旅行箱<span class="glyphicon glyphicon-fire"></span></a>
							<a href="###">真皮包</a>
							<a href="###">韩版</a>
							<a href="###">单肩包</a>
							<a href="###">达芙妮</a>
							<a href="###">靴子</a>
							<a href="###">毛线</a>
						</li>
					</div>
				</div>
				<div class="col-lg-5 thumbnailImg">
					<img src="images/jumbotron3.jpg">
					<div class="mouseTail"></div>
					<div class="row">
						<div class="col-lg-12">
							<button class="btn btn-default detailedImg center-block distinct">观看清晰图片</button>
						</div>						
					</div>					
					<div class="row">
						<div class="col-lg-12">
							<ul class="list-unstyled">
								<li><img class="thumbnail" src="images/jumbotron3.jpg"></li>
								<li><img class="thumbnail" src="images/jumbotron2.jpg"></li>
								<li><img class="thumbnail" src="images/jumbotron1.jpg"></li>
							</ul>
						</div>
					</div>
					<div class="row">
						<div class="col-lg-12 attrSection">
							<ul class="attrCards nav nav-tabs">
								<li class="presentation active"><a>产品属性</a></li>
								<li class="presentation"><a>产品尺码表</a></li>
								<li class="presentation"><a>产品介绍</a></li>
							</ul>
							<div class="attr activeAttr">
								<p>
									声明一个轮询函数将间歇调用改变为超时调用.
									在开发中经常使用超时调用模拟间歇调用,这是一种最佳模式,因为间歇调用时,后一个调用可能会在前一个调用结束之前启动.
								</p>
							</div>
							<div class="attr">
								<p>
									在1995年时，由Netscape公司的Brendan Eich，在网景导航者浏览器上首次设计实现而成。因为Netscape与Sun合作，Netscape管理层希望它外观看起来像Java，因此取名为JavaScript。但实际上它的语法风格与Self及Scheme较为接近。
								</p>
							</div>
							<div class="attr">
								<p>
									为了取得技术优势，微软推出了VBScript来迎战JavaScript的脚本语言。为了互用性，Ecma国际（前身为欧洲计算机制造商协会）创建了ECMA-262标准（ECMAScript）。现在两者都属于ECMAScript的实现。尽管JavaScript作为给非程序人员的脚本语言，而非是作为给程序人员的编程语言来推广和宣传，但是JavaScript具有非常丰富的特性。[1]
								</p>
							</div>
						</div>
					</div>					
				</div>
				<div class="col-lg-5 goodDesc">
					<div class="magnifying col-lg-5"></div>
					<h4><strong>无尽深渊</strong></h4>
					<p class="content">Netscape在最初将其脚本语言命名为LiveScript，后来Netscape在与Sun合作之后将其改名为JavaScript。JavaScript最初受Java启发而开始设计的，目的之一就是“看上去像Java”，因此语法上有类似之处，一些名称和命名规范也借自Java。但JavaScript的主要设计原则源自Self和Scheme。JavaScript与Java名称上的近似，是当时网景为了营销考虑与太阳微系统达成协议的结果。为了取得技术优势，微软推出了JScript来迎战JavaScript的脚本语言。</p>
					<p><span>价格:</span><span><s>379.0元</s></span></p>
					<p><span>促销:</span><span class="onSale">200.0元</span></p>
					<p><span>颜色:</span><span class="colorValue">未选择</span></p>
					<p><span></span><span>
						<button class="btn btn-success btn-lg" data-color="绿色"> </button>
						<button class="btn btn-warning btn-lg" data-color="橘色"> </button>
						<button class="btn btn-info btn-lg" data-color="天蓝色"> </button>
					</span></p>
					<p><span>尺寸:</span><span class="sizeValue">未选择</span></p>
					<p><span></span><span>
						<button class="btn btn-default" data-size="S">S</button>
						<button class="btn btn-default" data-size="L">L</button>
						<button class="btn btn-default" data-size="SL">SL</button>
						<button class="btn btn-default" data-size="LL">LL</button>
					</span></p>
					<p><span>数量:</span><span>
						<select class="amount input-sm">
							<option>1</option>
							<option>2</option>
							<option>3</option>
							<option>4</option>
							<option>5</option>
						</select>
					</span></p>
					<p><span>总计:</span><span class="price">200元</span></p>
					<p class="score"><span>给商品评分:</span>
						<span class="sr-only">显示这个商品的评分.</span>
						<span class="glyphicon glyphicon-heart-empty"></span>
						<span class="glyphicon glyphicon-heart-empty"></span>
						<span class="glyphicon glyphicon-heart-empty"></span>
						<span class="glyphicon glyphicon-heart-empty"></span>
						<span class="glyphicon glyphicon-heart-empty"></span>						
					</p>
					<button class="btn btn-primary submit" type="submit">放入购物车</button>
				</div>		
			</div>
		</div>
	</div>
<!--引入bootstrap和后面DOM操作所必须的jQuery库-->
<script src="js/jQuery/jquery-1.11.3.min.js"></script>
<script src="js/bootstrap/js/bootstrap.min.js"></script>
<!--引入自己的插件,其中本页面使用到了imgReal()和mask()两个功能,分别提供获取照片实际尺寸和提供蒙版效果-->
<script src="js/plugins/jquery.plugins.js"></script>
<script>
	//等待DOM树加载完成
	$(function(){
		//定义三张缩略图和一个提供放大镜以及滚轮控制尺寸,可以移动大小的细节图.
		var $thumbnail=$('.thumbnail');
		var $detailedImg=$('.thumbnailImg>img');
		//使用插件中的imgReal()方法,并使用回调函数获取图片的实际尺寸.
		$detailedImg.imgReal(function(realWidth,realHeight){
			$detailedImg.attr('data-realWidth',realWidth);				
			$detailedImg.attr('data-realHeight',realHeight);				
		});
		//当缩略图被点击时选中为细节图,双击时提供蒙版效果(可以滚轮控制尺寸,鼠标拖动位置).
		$thumbnail.bind('click',function(){
			$detailedImg.attr('src',$(this).attr('src'));
			
		}).bind('dblclick',function(){
			//使用了自定义插件中蒙版方法.
			$detailedImg.mask();
		});

		//定义清晰按钮,当点击时蒙版显示.
		var $distinct=$('.distinct');
		$distinct.bind('click',function(){
			$detailedImg.mask();
		});

		//定义放大镜的窗口
		var $magnifying=$('.magnifying');
		
		
		
		//定义放大镜功能时在原图上显示的鼠标放大指示区域
		var $mouseTail=$('.mouseTail');		
		var widthMultiple,heightMultiple;
		
		$detailedImg.one('mouseover',function(){			
			//定义放大镜窗口和细节图中两个图片的高度放大比例,宽度放大比例(因为并不是标准正方形,所以当鼠标在图片上移动时需要这个比例来控制显示区域).
			widthMultiple=$detailedImg.attr('data-realWidth')/$detailedImg.width();
			heightMultiple=$detailedImg.attr('data-realHeight')/$detailedImg.height();
			//定义鼠标指示区域宽度为细节图与放大比例的商,高度等于宽度(指示区域和放大镜区域均设计为正方形).
			$mouseTail.width($magnifying.width()/widthMultiple);
			$mouseTail.height($magnifying.width()/widthMultiple);
		});
		//细节图绑定鼠标移入事件
		$detailedImg.bind('mouseover',function(event){	
			
			
			//当第一次出现指示区域时定位到鼠标当前位置为区域中心并显示.
			$mouseTail.css('left',event.pageX-0.5*$mouseTail.width());
			$mouseTail.css('top',event.pageY-0.5*$mouseTail.width());
			$mouseTail.show();


		});

		//对鼠标指示区域分别绑定鼠标移入移出和移动行为.
		$mouseTail.bind('mouseover',function(){
			//定义放大区域的高度并设置背景图片为细节图,然后显示放大区域(通过控制背景图片的位置来设计放大效果).				
			$magnifying.height($magnifying.width());
			$magnifying.css('backgroundImage','url('+$detailedImg.attr('src')+')');
			$magnifying.show();
		}).bind('mousemove',function(e){
			//将鼠标当前的位置信息获取下来(因为后面会使用两次,所以这样可以提升性能).
			var pageX=e.pageX;
			var pageY=e.pageY;
			//当鼠标移动时控制指示区域始终将鼠标置于中心.
			$mouseTail.css('left',pageX-0.5*$mouseTail.width());
			$mouseTail.css('top',pageY-0.5*$mouseTail.width());
			//获取细节图上鼠标的相对偏移量方便后面控制放大图的放大区域时使用
			offsetLeft=-pageX+(+($detailedImg.offset().left));
			offsetTop=-pageY+(+($detailedImg.offset().top));
			//下面的3分支语句用来控制鼠标移动到临左边缘,临右边缘和非边缘时分别显示的放大区域和鼠标指示区域.
			//当鼠标移动到临右边缘时
			if(offsetLeft*widthMultiple<=0.5*$magnifying.width()-$detailedImg.attr('data-realWidth')){
				//使放大区域为原图最右一个放大框的宽度(其中最后加了一个偏移量,现在不太清楚这个偏移量哪来的,如果影响显示的话再调,初步估计是左边距的问题).
				offsetLeft=-($detailedImg.attr('data-realWidth')-$magnifying.width()-30);
				//使鼠标指示区域的左偏移量控制为图片最右
				$mouseTail.css('left',$detailedImg.offset().left+$detailedImg.width()-$mouseTail.width());
			}else if(offsetLeft*widthMultiple>-0.5*$magnifying.width()){
			//当鼠标移动到最左边缘时
				//设置放大区域背景图片偏移量为0.
				offsetLeft=0;
				//设置鼠标指示区域的左偏移量为图片最左.
				$mouseTail.css('left',$detailedImg.offset().left);
			}else{
			//当鼠标在非边缘区域时
				//设置放大区域背景图片偏移量.
				offsetLeft=offsetLeft*widthMultiple+0.5*$magnifying.width();
				//设置鼠标指示区域的左偏移量.
				$mouseTail.css('left',event.pageX-0.5*$mouseTail.width());
			}
			//下面的3分支语句用来控制鼠标移动到临上边缘,临下边缘和非边缘区域时分别显示的放大区域背景图片偏移量和鼠标指示区域.
			//详细设计原理参考上面的3分支语句.
			if(offsetTop*widthMultiple<=0.5*$magnifying.height()-$detailedImg.attr('data-realHeight')){
				offsetTop=-($detailedImg.attr('data-realHeight')-$magnifying.height());
				$mouseTail.css('top',$detailedImg.offset().top+$detailedImg.height()-$mouseTail.height());
			}else if(offsetTop*widthMultiple>-0.5*$magnifying.height()){
				offsetTop=0;
				$mouseTail.css('top',$detailedImg.offset().top);
			}else{
				offsetTop=offsetTop*widthMultiple+0.5*$magnifying.height();
				$mouseTail.css('top',event.pageY-0.5*$mouseTail.width());
			}
			//设置放大区域背景图片偏移量.
			$magnifying.css('backgroundPosition', offsetLeft+'px '+offsetTop+'px');
		}).bind('mouseout',function(){
		//当鼠标移出指示区域时(即鼠标离开细节图时).
			//隐藏放大区域和指示区域.
			$magnifying.hide();
			$mouseTail.hide();
		})

		//选项卡功能
		var $attrCards=$('.attrCards li');
		var $attr=$('.attr');
		//本选项卡使用了bootstrap中的nav nav-tabs类,所以只用添加active类就可以显示炫酷的特效
		$attrCards.bind('click',function(){
			$(this).addClass('active').siblings().removeClass('active');
			//隐藏兄弟节点,显示自己.
			$attr.eq($(this).index()).show().siblings().filter('.attr').hide();
		})

		//选择色彩功能
		//通过属性选择器来选择含有自己想要功能的按钮集合(当元素中有一些自己想要定义的一些显示无关的属性时,使用data-yourAttr来命名).
		var $selectColor=$('button[data-color]');
		var $colorValue=$('.colorValue');
		$selectColor.bind('click',function(){
			$colorValue.text($(this).attr('data-color'));
		})

		//选择尺寸功能,与上同理.
		var $selectSize=$('button[data-size]');
		var $sizeValue=$('.sizeValue');
		$selectSize.bind('click',function(){
			$sizeValue.text($(this).attr('data-size'));
		})

		//计算总价功能,原理就是获取键值,转为数字,乘可得.
		var $amount=$('.amount');
		var $price=$('.price');
		var unitPrice=parseInt($('.onSale').text());
		$amount.bind('change',function(){
			$price.text($(this).val()*unitPrice+"元");
		})

		//评分功能.
		//获取打分项里的5个心图标,如果没分则为glyphicon-heart-empty,否则为glyphicon-heart.
		var $score=$('.score .glyphicon');
		$score.bind('mouseover',function(){
			//先全部设置为满心(因为jQuery中只有nextAll()过滤器,没有preAll()过滤器,不过可以写个插件,除了麻烦一点,自己的选择器插件还是有bug).
			$score.removeClass('glyphicon-heart-empty').addClass('glyphicon-heart');
			//将当前对象后的所有图片置换为空心类.
			$(this).nextAll("span").removeClass('glyphicon-heart').addClass('glyphicon-heart-empty');
		}).bind('click',function(){
			//当点击时确定打分结果.
			$(this).nextAll("span").removeClass('glyphicon-heart').addClass('glyphicon-heart-empty');
		})

		//提交表单确认功能(不提供校验和提交功能)
		var $submit=$('.submit');
		$submit.bind('click',function(){
			//将表单中的信息序列化组成确认信息.
			var goodInfo="您购买的产品是:无尽深渊\n尺寸是:"+$sizeValue.text()+"\n颜色是:"+$colorValue.text()+"\n数量是:"+$amount.val()+"\n总价格是:"+$price.text()+'.\n';
			//当提交时给出选择框让用户确认是否购买了正确的商品.
			if(confirm(goodInfo)){
				//如果确认,则弹出文本(使用了插件中文字蒙版方法,其中$()对象指的是document).
				$().mask("感谢您对本店的支持,小二已经将您的货物整理好,准备出发了,谢谢客官的打赏.");
			}else{
				//如果否认,则不提交.
				return false;
			};
		})
		
	})	
</script>
</body>
</html>